#todo move logice code from controller to service layer